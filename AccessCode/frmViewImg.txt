Option Compare Database

Private Sub Form_Current()
    ' نعرض الصورة الحالية للسجل
    LoadImageFromBytes Me.Image9, Me.ImageProduct, "Product_" & Me.ProductID & "_" & Me.ProductImagesID & ".jpg"
End Sub

'Private Sub LoadProductImage(ProductID As Long)
'    On Error GoTo ErrHandler
'
'    Dim rs As Object
'    Dim fileData() As Byte
'    Dim tempPath As String
'    Dim fileNum As Integer
'    Dim sql As String
'
'    ' تأكد إن ProductID موجود
'    If ProductID = 0 Then
'        Me.Image9.Picture = ""
'        Exit Sub
'    End If
'
'    ' استعلام SQL صحيح
'    sql = "SELECT TOP 1 [ImageProduct] FROM [dbo_ProductImages] WHERE [ProductID]=" & ProductID
'
'    Set rs = CreateObject("ADODB.Recordset")
'    rs.Open sql, CurrentProject.Connection, 1, 3 ' 1=adOpenKeyset, 3=adLockOptimistic
'
'    If Not rs.EOF And Not IsNull(rs.Fields("ImageProduct").Value) Then
'        fileData = rs.Fields("ImageProduct").Value
'        tempPath = Environ("TEMP") & "\Product_" & ProductID & ".jpg"
'
'        ' كتابة الصورة على قرص مؤقت
'        fileNum = FreeFile
'        Open tempPath For Binary As #fileNum
'            Put #fileNum, , fileData
'        Close #fileNum
'
'        Me.Image9.Picture = tempPath
'    Else
'        Me.Image9.Picture = "" ' لو مفيش صورة
'    End If
'
'    rs.Close
'    Exit Sub
'
'ErrHandler:
'    MsgBox "Error loading image: " & Err.Description
'End Sub

